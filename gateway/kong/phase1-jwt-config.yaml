# Kong JWT Plugin Configuration for KCardSwap
# This configuration will be used in Phase 1 to integrate Kong JWT verification

_format_version: "3.0"

services:
  - name: kcardswap-backend
    url: http://backend:8000
    routes:
      - name: auth-routes
        paths:
          - /api/v1/auth
        strip_path: false
        
      - name: profile-routes
        paths:
          - /api/v1/profile
        strip_path: false
        plugins:
          - name: jwt
            config:
              # JWT plugin configuration
              # Will verify JWT tokens before forwarding to backend
              uri_param_names:
                - jwt
              cookie_names: []
              header_names:
                - authorization
              claims_to_verify:
                - exp
              key_claim_name: iss
              secret_is_base64: false
              run_on_preflight: true
              maximum_expiration: 900  # 15 minutes
              
      - name: api-routes
        paths:
          - /api/v1
        strip_path: false

# Note: Actual JWT credentials and secrets will be configured separately
# using Kong Admin API or declarative configuration with environment variables
