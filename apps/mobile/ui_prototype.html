<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCardSwap ç”¢å“è¨­è¨ˆè¦æ ¼å°è¦½ - V4 (Fixed & Complete)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F8FAFC;
        }
        
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: auto;
            height: 300px;
        }

        .phone-frame {
            box-shadow: 0 50px 100px -20px rgba(0, 0, 0, 0.25);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-item.active {
            background-color: #4F46E5;
            color: white;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }

        /* Animation for Slide Up Modal */
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        .animate-slide-up { animation: slideUp 0.3s ease-out; }
    </style>
</head>
<body class="text-slate-800">

    <!-- REQUIRED PLACEHOLDERS -->
    <!-- Chosen Palette: Indigo-600 (Primary), Pink-500 (Secondary), Slate-50 (Bg) -->
    <!-- Application Structure Plan: 
         1. å´é‚Šæ¬„å°èˆªï¼šæ§åˆ¶ä¸»è¦è¦æ ¼ç« ç¯€ã€‚
         2. äº’å‹•åŸå‹å€ï¼š
            - Entry: Google Login æ¨¡æ“¬ã€‚
            - Flow: Login -> Loading -> Onboarding (Bias Selection) -> Main App.
            - Main App: å®Œæ•´çš„ Tab åˆ‡æ› (é¦–é /é™„è¿‘/ä¸Šå‚³/èŠå¤©/å€‹äºº) èˆ‡è©³ç´°é é¢æ¨¡æ“¬ã€‚
         3. äº¤æ›é‚è¼¯å€ï¼šäº’å‹•å¼æ­¥é©Ÿæ¢ï¼Œé»æ“Šé¡¯ç¤ºç‹€æ…‹æ©Ÿç´°ç¯€ã€‚
         4. æœƒå“¡æ¬Šç›Šå€ï¼šChart.js é›·é”åœ–ã€‚ -->
    <!-- Visualization & Content Choices:
         - Mobile Simulator: HTML/CSS/JS å…¨åŠŸèƒ½æ¨¡æ“¬ã€‚
         - Step-by-Step Logic: äº’å‹•å¼ Gridã€‚
         - Data Viz: Canvas Chart.jsã€‚
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <div class="min-h-screen flex flex-col md:flex-row">
        
        <!-- Sidebar -->
        <aside class="w-full md:w-72 bg-white border-r border-slate-200 flex-shrink-0 sticky top-0 md:h-screen overflow-y-auto z-20">
            <div class="p-8">
                <h1 class="text-2xl font-black text-indigo-600 tracking-tighter">KCardSwap<span class="text-pink-500">.</span></h1>
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-2">Design Spec V4 (Fixed)</p>
            </div>
            
            <nav class="px-6 space-y-1">
                <button onclick="switchSection('login-spec')" class="nav-item active w-full text-left px-4 py-4 rounded-xl text-sm font-bold transition-all flex items-center">
                    <span class="mr-3 text-lg">ğŸ”‘</span> ç™»å…¥æµç¨‹è¦ç¯„
                </button>
                <button onclick="switchSection('prototype')" class="nav-item w-full text-left px-4 py-4 rounded-xl text-sm font-bold transition-all flex items-center">
                    <span class="mr-3 text-lg">ğŸ“±</span> äº’å‹•åŸå‹é è¦½
                </button>
                <button onclick="switchSection('trade-logic')" class="nav-item w-full text-left px-4 py-4 rounded-xl text-sm font-bold transition-all flex items-center">
                    <span class="mr-3 text-lg">ğŸ”„</span> äº¤æ›ç‹€æ…‹æ©Ÿ
                </button>
                <button onclick="switchSection('membership')" class="nav-item w-full text-left px-4 py-4 rounded-xl text-sm font-bold transition-all flex items-center">
                    <span class="mr-3 text-lg">ğŸ’</span> å•†æ¥­åŒ–æ¨¡å‹
                </button>
            </nav>

            <div class="mt-auto p-8 border-t border-slate-50">
                <div class="bg-green-50 p-4 rounded-xl border border-green-100">
                    <p class="text-[10px] text-green-600 font-bold uppercase mb-1">Status: Fixed</p>
                    <p class="text-xs text-green-800 font-medium">æ‰€æœ‰äº’å‹•æµç¨‹å·²ä¿®å¾©ï¼ŒåŒ…å« App å…§å°èˆªèˆ‡é‚è¼¯å±•ç¤ºã€‚</p>
                </div>
            </div>
        </aside>

        <!-- Content Area -->
        <main class="flex-1 bg-slate-50 p-4 md:p-12 overflow-y-auto" id="main-content">
            
            <!-- SECTION: LOGIN SPEC -->
            <section id="login-spec-section" class="space-y-8 animate-fade-in">
                <div class="max-w-4xl">
                    <h2 class="text-3xl font-black text-slate-900 mb-4">ç™»å…¥æµç¨‹è¦ç¯„ (Login Workflow)</h2>
                    <p class="text-lg text-slate-500 mb-8">æ¡ç”¨ Google OAuth 2.0 ä½œç‚ºä¸»è¦èº«åˆ†é©—è­‰æ‰‹æ®µï¼Œæ—¨åœ¨æ¸›å°‘è¨»å†Šè² æ“”ä¸¦æå‡å®‰å…¨æ€§ã€‚</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="text-2xl mb-4">âš¡</div>
                            <h3 class="font-bold mb-2">æ¥µé€Ÿå…¥å£</h3>
                            <p class="text-xs text-slate-500 leading-relaxed">é¦–å±åƒ…ä¿ç•™ Google ç™»å…¥æŒ‰éˆ•ï¼Œé»æ“Šå¾Œèª¿ç”¨ç³»çµ±åŸç”Ÿæˆæ¬Šå½ˆçª—ï¼Œå¹³å‡å®Œæˆæ™‚é–“é è¨ˆå°‘æ–¼ 5 ç§’ã€‚</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="text-2xl mb-4">ğŸ›¡ï¸</div>
                            <h3 class="font-bold mb-2">å®‰å…¨èˆ‡ä¿¡ä»»</h3>
                            <p class="text-xs text-slate-500 leading-relaxed">åˆ©ç”¨ Google çš„é›™é‡èªè­‰æ©Ÿåˆ¶ï¼Œé™ä½è™›å‡å¸³è™Ÿé¢¨éšªï¼Œå°å°å¡äº¤æ›å¸‚å ´çš„ä¿¡è­½å»ºç«‹è‡³é—œé‡è¦ã€‚</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                            <div class="text-2xl mb-4">ğŸ‘¤</div>
                            <h3 class="font-bold mb-2">è‡ªå‹•åŒ–å»ºæª”</h3>
                            <p class="text-xs text-slate-500 leading-relaxed">è‡ªå‹•æŠ“å– Google é ­åƒèˆ‡å§“åä½œç‚ºé è¨­å€‹äººè³‡æ–™ï¼Œå¾ŒçºŒåƒ…éœ€è£œå……ã€Œæœ¬å‘½åœ˜é«”ã€å³å¯å®Œæˆé–‹é€šã€‚</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION: PROTOTYPE -->
            <section id="prototype-section" class="hidden space-y-8 animate-fade-in">
                <div class="grid grid-cols-1 xl:grid-cols-2 gap-12 items-start">
                    
                    <div class="space-y-6">
                        <div class="bg-indigo-900 text-white p-8 rounded-3xl shadow-2xl">
                            <h3 class="text-xl font-bold mb-4">äº’å‹•åŸå‹å°è¦½</h3>
                            <p class="text-indigo-200 text-sm mb-6">è«‹åœ¨å³å´æ¨¡æ“¬å™¨é€²è¡Œæ“ä½œï¼Œé«”é©—å®Œæ•´çš„ User Journeyã€‚</p>
                            
                            <div class="space-y-4">
                                <div class="flex items-center text-sm">
                                    <span class="w-6 h-6 rounded-full bg-indigo-700 flex items-center justify-center mr-3 text-xs">1</span>
                                    <span>é»æ“Š <strong>Google ç™»å…¥</strong></span>
                                </div>
                                <div class="flex items-center text-sm">
                                    <span class="w-6 h-6 rounded-full bg-indigo-700 flex items-center justify-center mr-3 text-xs">2</span>
                                    <span>å®Œæˆ <strong>æœ¬å‘½é¸æ“‡ (Onboarding)</strong></span>
                                </div>
                                <div class="flex items-center text-sm">
                                    <span class="w-6 h-6 rounded-full bg-white text-indigo-900 flex items-center justify-center mr-3 text-xs font-bold">3</span>
                                    <span class="font-bold text-white">é€²å…¥ä¸» Appï¼Œè‡ªç”±åˆ‡æ› Tab åŠŸèƒ½</span>
                                </div>
                            </div>

                            <button onclick="resetSimulator()" class="mt-8 text-xs font-bold bg-indigo-800 hover:bg-indigo-700 px-4 py-2 rounded-lg transition-colors">â†º é‡ç½®æ¨¡æ“¬å™¨</button>
                        </div>
                    </div>

                    <!-- Simulator Container -->
                    <div class="flex justify-center relative">
                        <div class="phone-frame w-[340px] h-[700px] bg-black rounded-[3.5rem] p-3 border-4 border-slate-800 relative z-10 overflow-hidden">
                            <!-- Notch -->
                            <div class="absolute top-0 left-1/2 -translate-x-1/2 w-40 h-8 bg-black rounded-b-2xl z-30"></div>
                            
                            <!-- Internal Screen -->
                            <div id="phone-screen" class="w-full h-full bg-white rounded-[2.8rem] overflow-hidden relative font-sans">
                                <!-- Content injected via JS -->
                            </div>
                        </div>
                        <!-- Decorative glow -->
                        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-96 bg-indigo-500/20 blur-[120px] rounded-full"></div>
                    </div>
                </div>
            </section>

            <!-- SECTION: TRADE LOGIC -->
            <section id="trade-logic-section" class="hidden animate-fade-in">
                <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-100">
                    <h2 class="text-2xl font-bold mb-2">äº¤æ›ç‹€æ…‹æ©Ÿ (Trading State Machine)</h2>
                    <p class="text-slate-500 mb-8">é»æ“Šä¸‹æ–¹æ­¥é©Ÿå¡ç‰‡ï¼ŒæŸ¥çœ‹è©²ç‹€æ…‹ä¸‹çš„ç³»çµ±é‚è¼¯èˆ‡ UI è¡Œç‚ºã€‚</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                        <div onclick="highlightStep(1)" class="p-4 bg-indigo-50 border-2 border-transparent hover:border-indigo-500 rounded-xl cursor-pointer transition-all group">
                            <div class="text-2xl mb-2">ğŸ¤</div>
                            <h3 class="font-bold text-indigo-900">1. ç™¼èµ·ææ¡ˆ</h3>
                            <p class="text-xs text-indigo-600 mt-1 opacity-60 group-hover:opacity-100">Initiate</p>
                        </div>
                        <div onclick="highlightStep(2)" class="p-4 bg-amber-50 border-2 border-transparent hover:border-amber-500 rounded-xl cursor-pointer transition-all group">
                            <div class="text-2xl mb-2">âš–ï¸</div>
                            <h3 class="font-bold text-amber-900">2. å”å•†ä¸­</h3>
                            <p class="text-xs text-amber-600 mt-1 opacity-60 group-hover:opacity-100">Negotiate</p>
                        </div>
                        <div onclick="highlightStep(3)" class="p-4 bg-blue-50 border-2 border-transparent hover:border-blue-500 rounded-xl cursor-pointer transition-all group">
                            <div class="text-2xl mb-2">ğŸ”’</div>
                            <h3 class="font-bold text-blue-900">3. é–å®šå®Œæˆ</h3>
                            <p class="text-xs text-blue-600 mt-1 opacity-60 group-hover:opacity-100">Complete</p>
                        </div>
                        <div onclick="highlightStep(4)" class="p-4 bg-green-50 border-2 border-transparent hover:border-green-500 rounded-xl cursor-pointer transition-all group">
                            <div class="text-2xl mb-2">â­ï¸</div>
                            <h3 class="font-bold text-green-900">4. è©•åƒ¹</h3>
                            <p class="text-xs text-green-600 mt-1 opacity-60 group-hover:opacity-100">Rating</p>
                        </div>
                    </div>

                    <div id="flow-detail" class="bg-slate-900 text-slate-300 p-6 rounded-2xl min-h-[150px] flex items-center justify-center">
                        <p class="text-sm italic opacity-50">â† è«‹é»æ“Šä¸Šæ–¹æ­¥é©ŸæŸ¥çœ‹ç´°ç¯€</p>
                    </div>
                </div>
            </section>

            <!-- SECTION: MEMBERSHIP -->
            <section id="membership-section" class="hidden animate-fade-in">
                <div class="bg-white p-8 rounded-3xl shadow-sm border border-slate-100">
                    <h2 class="text-2xl font-bold mb-6">æ¬Šç›Šå±¤ç´šå°æ¯”</h2>
                    <div class="chart-container">
                        <canvas id="membershipChart"></canvas>
                    </div>
                    <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center font-bold mr-4 text-xs">F</div>
                            <div>
                                <h4 class="font-bold text-slate-900">å…è²»æœƒå“¡ (Free)</h4>
                                <p class="text-xs text-slate-500 mt-1">é©åˆè¼•åº¦ä½¿ç”¨è€…ã€‚æ¯æ—¥ä¸Šå‚³èˆ‡æœå°‹æ¬¡æ•¸å—é™ï¼Œè¶³ä»¥é«”é©—åŸºæœ¬åŠŸèƒ½ã€‚</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold mr-4 text-xs">P</div>
                            <div>
                                <h4 class="font-bold text-slate-900">å°ˆæ¥­æœƒå“¡ (Premium)</h4>
                                <p class="text-xs text-slate-500 mt-1">è§£é–ç„¡é™ä¸Šå‚³ã€LBS å„ªå…ˆæ’åºèˆ‡å°ˆå±¬èº«åˆ†æ¨™è­˜ï¼Œé©åˆé‡åº¦äº¤æ›ç©å®¶ã€‚</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- JS Logic -->
    <script>
        // --- Navigation ---
        function switchSection(id) {
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            document.getElementById(id + '-section').classList.remove('hidden');
            
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            const btn = document.querySelector(`button[onclick="switchSection('${id}')"]`);
            if(btn) btn.classList.add('active');

            if(id === 'membership') renderChart();
        }

        // --- Mock Data ---
        const mockData = {
            feeds: [
                { user: 'HanniFan_TW', time: '10m', title: 'ã€æ±‚æ›ã€‘Hanni è—ç‰ˆ æ› Minji', tag: 'NewJeans' },
                { user: 'Blink_0808', time: '1h', title: 'Lisa Solo å°ˆè¼¯å°å¡å‡ºå”®', tag: 'BLACKPINK' },
                { user: 'Carat_17', time: '2h', title: 'Seventeen FML æ›åœ“ä½‘', tag: 'SEVENTEEN' }
            ],
            nearby: [
                { name: 'JennieKim', dist: '0.5km', vip: true },
                { name: 'StayKidsUser', dist: '1.2km', vip: false },
                { name: 'AespaWinter', dist: '2.5km', vip: false }
            ]
        };

        // --- Simulator Logic ---
        const phoneScreen = document.getElementById('phone-screen');
        let currentTab = 'home';

        // 1. Initial State: Login
        function initSimulator() {
            phoneScreen.innerHTML = `
                <div class="h-full flex flex-col items-center justify-between p-8 py-20 animate-fade-in">
                    <div class="text-center">
                        <div class="w-20 h-20 bg-indigo-600 rounded-3xl mx-auto flex items-center justify-center text-3xl shadow-2xl mb-4">ğŸ“‚</div>
                        <h2 class="text-2xl font-black text-slate-900">KCardSwap</h2>
                        <p class="text-xs text-slate-400 mt-1 uppercase tracking-widest font-bold">Find Your Bias</p>
                    </div>

                    <div class="w-full space-y-4">
                        <button onclick="triggerGoogleLogin()" class="w-full h-16 bg-white border border-slate-200 rounded-2xl flex items-center px-6 hover:bg-slate-50 transition-all shadow-sm group">
                            <div class="w-8 h-8 flex items-center justify-center text-xl mr-4 group-hover:scale-110 transition-transform">
                                G
                            </div>
                            <span class="font-bold text-slate-700">ä½¿ç”¨ Google å¸³è™Ÿç™»å…¥</span>
                        </button>
                        <p class="text-[9px] text-slate-400 text-center px-4 leading-relaxed">
                            ç™»å…¥å³è¡¨ç¤ºæ‚¨åŒæ„æœ¬å¹³å°çš„æœå‹™æ¢æ¬¾èˆ‡éš±ç§å”è­°ã€‚
                        </p>
                    </div>
                </div>
            `;
        }

        // 2. Auth Loading
        function triggerGoogleLogin() {
            phoneScreen.innerHTML = `
                <div class="h-full flex flex-col items-center justify-center space-y-6 animate-fade-in">
                    <div class="relative">
                        <div class="w-16 h-16 border-4 border-slate-100 border-t-indigo-600 rounded-full animate-spin"></div>
                        <div class="absolute inset-0 flex items-center justify-center text-lg font-bold text-slate-700">G</div>
                    </div>
                    <p class="text-sm font-bold text-slate-500">æ­£åœ¨é€£æ¥ Google å¸³è™Ÿ...</p>
                </div>
            `;
            setTimeout(renderOnboarding, 1500);
        }

        // 3. Onboarding
        function renderOnboarding() {
            phoneScreen.innerHTML = `
                <div class="h-full flex flex-col p-6 pt-10 animate-fade-in">
                    <div class="flex items-center space-x-3 mb-8">
                        <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center">ğŸ‘¤</div>
                        <div>
                            <p class="text-xs text-slate-400 font-bold">ä½ å¥½ï¼ŒUserï¼</p>
                            <p class="text-sm font-black text-slate-900">æœ€å¾Œä¸€æ­¥ï¼šé¸æ“‡ä½ çš„æœ¬å‘½</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3 mb-auto">
                        <div onclick="toggleSelection(this)" class="p-4 border border-slate-100 rounded-2xl text-center hover:border-indigo-600 transition-all cursor-pointer bg-white shadow-sm">
                            <span class="text-2xl">ğŸ‘–</span><p class="text-[10px] font-bold mt-2">NewJeans</p>
                        </div>
                        <div onclick="toggleSelection(this)" class="p-4 border-2 border-indigo-600 rounded-2xl text-center transition-all cursor-pointer bg-indigo-50 relative">
                            <span class="text-2xl">ğŸ¦¢</span><p class="text-[10px] font-bold mt-2 text-indigo-700">IVE</p>
                            <div class="absolute top-2 right-2 w-4 h-4 bg-indigo-600 rounded-full flex items-center justify-center text-[8px] text-white">âœ“</div>
                        </div>
                        <div onclick="toggleSelection(this)" class="p-4 border border-slate-100 rounded-2xl text-center hover:border-indigo-600 transition-all cursor-pointer bg-white shadow-sm">
                            <span class="text-2xl">ğŸ¦‹</span><p class="text-[10px] font-bold mt-2">aespa</p>
                        </div>
                        <div onclick="toggleSelection(this)" class="p-4 border-2 border-indigo-600 rounded-2xl text-center transition-all cursor-pointer bg-indigo-50 relative">
                            <span class="text-2xl">ğŸŒ¸</span><p class="text-[10px] font-bold mt-2 text-indigo-700">LE SSERAFIM</p>
                             <div class="absolute top-2 right-2 w-4 h-4 bg-indigo-600 rounded-full flex items-center justify-center text-[8px] text-white">âœ“</div>
                        </div>
                    </div>
                    
                    <button onclick="renderMainApp()" class="w-full bg-slate-900 text-white font-bold py-4 rounded-2xl mt-8 shadow-xl">é–‹å§‹æ¢ç´¢å°å¡</button>
                </div>
            `;
        }

        function toggleSelection(el) {
            el.classList.toggle('border-indigo-600');
            el.classList.toggle('bg-indigo-50');
            el.classList.toggle('border-slate-100');
        }

        // 4. Main App Container
        function renderMainApp() {
            phoneScreen.innerHTML = `
                <div class="h-full bg-slate-50 flex flex-col pt-12 animate-fade-in relative">
                    <!-- Header -->
                    <header id="app-header" class="px-6 py-4 flex justify-between items-center bg-white shadow-sm z-10">
                        <div class="flex flex-col">
                            <span class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Discover</span>
                            <h3 class="text-xl font-black text-slate-900" id="header-title">åŸå¸‚çœ‹æ¿</h3>
                        </div>
                        <div class="w-8 h-8 bg-indigo-600 rounded-full border-2 border-white shadow-lg flex items-center justify-center text-white text-xs">U</div>
                    </header>

                    <!-- Dynamic Body -->
                    <div id="app-body" class="flex-1 overflow-y-auto pb-24 relative">
                        <!-- Content goes here -->
                    </div>

                    <!-- Bottom Nav -->
                    <nav class="absolute bottom-6 left-6 right-6 h-16 bg-white/90 backdrop-blur-md border border-white/20 shadow-2xl rounded-3xl flex justify-around items-center px-2 z-20">
                        <button onclick="renderTab('home')" class="nav-btn text-xl text-indigo-600 transition-transform active:scale-90">ğŸ </button>
                        <button onclick="renderTab('nearby')" class="nav-btn text-xl text-slate-300 transition-transform active:scale-90">ğŸ“</button>
                        <button onclick="renderTab('upload')" class="w-12 h-12 bg-slate-900 rounded-2xl flex items-center justify-center text-white text-xl shadow-lg -mt-8 transition-transform active:scale-90">+</button>
                        <button onclick="renderTab('chat')" class="nav-btn text-xl text-slate-300 transition-transform active:scale-90">ğŸ’¬</button>
                        <button onclick="renderTab('profile')" class="nav-btn text-xl text-slate-300 transition-transform active:scale-90">ğŸ‘¤</button>
                    </nav>
                </div>
            `;
            renderTab('home');
        }

        // 5. Tab Render Logic
        function renderTab(tab) {
            const body = document.getElementById('app-body');
            const title = document.getElementById('header-title');
            
            // Update Nav Icons Styling
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-indigo-600');
                btn.classList.add('text-slate-300');
            });
            // Simple mapping for demo; specific highlighting logic omitted for brevity
            
            if(tab === 'home') {
                title.innerText = 'åŸå¸‚çœ‹æ¿';
                body.innerHTML = `
                    <div class="px-6 py-4 space-y-4">
                        ${mockData.feeds.map(f => `
                            <div class="bg-white p-4 rounded-3xl shadow-sm border border-slate-100">
                                <div class="w-full h-32 bg-slate-100 rounded-2xl mb-3 bg-cover bg-center" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjZjFmM2Y1Ij48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIvPjwvc3ZnPg==')"></div>
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="font-bold text-sm text-slate-800">${f.title}</h4>
                                        <p class="text-[10px] text-slate-400 mt-1">@${f.user} â€¢ ${f.time}</p>
                                    </div>
                                    <span class="bg-indigo-50 text-indigo-600 text-[8px] font-bold px-2 py-1 rounded-full">#${f.tag}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } else if (tab === 'nearby') {
                title.innerText = 'é™„è¿‘çš„äºº';
                body.innerHTML = `
                    <div class="px-6 py-4 space-y-3">
                         <div class="flex justify-between items-center mb-2">
                            <span class="text-xs font-bold text-slate-400">è·é›¢ 5km å…§</span>
                        </div>
                        ${mockData.nearby.map(u => `
                            <div class="bg-white p-3 rounded-2xl shadow-sm border ${u.vip ? 'border-indigo-100 bg-indigo-50/30' : 'border-slate-100'} flex items-center justify-between">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-slate-200 rounded-full mr-3 relative">
                                        ${u.vip ? '<div class="absolute -top-1 -right-1 text-[8px]">ğŸ‘‘</div>' : ''}
                                    </div>
                                    <div>
                                        <p class="text-sm font-bold text-slate-800">${u.name}</p>
                                        <p class="text-[10px] text-indigo-500 font-bold">ğŸ“ ${u.dist}</p>
                                    </div>
                                </div>
                                <button class="bg-slate-900 text-white text-[10px] px-3 py-1.5 rounded-lg">æŸ¥çœ‹</button>
                            </div>
                        `).join('')}
                    </div>
                `;
            } else if (tab === 'upload') {
                body.innerHTML = `
                    <div class="absolute inset-0 bg-black/20 z-30 flex flex-col justify-end h-full">
                        <div class="bg-white rounded-t-[2rem] p-6 h-[85%] animate-slide-up shadow-2xl">
                            <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto mb-8"></div>
                            <div class="w-full h-40 bg-slate-50 rounded-2xl mb-6 flex flex-col items-center justify-center border-2 border-dashed border-slate-200 text-slate-400">
                                <span class="text-2xl mb-2">ğŸ“·</span>
                                <span class="text-xs font-bold">ä¸Šå‚³å°å¡ç…§ç‰‡</span>
                            </div>
                            <button onclick="renderTab('home')" class="w-full bg-slate-900 text-white font-bold py-4 rounded-2xl">ç™¼å¸ƒ</button>
                        </div>
                    </div>
                `;
            } else if (tab === 'chat') {
                title.innerText = 'è¨Šæ¯ (1)';
                body.innerHTML = `
                    <div class="px-6 py-4">
                        <div class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-indigo-100 rounded-full mr-3 relative">
                                    <div class="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full"></div>
                                </div>
                                <div>
                                    <p class="text-sm font-bold text-slate-800">JennieKim</p>
                                    <p class="text-[10px] text-slate-500">å¥½çš„ï¼Œé‚£é¢äº¤è¦‹ï¼</p>
                                </div>
                            </div>
                            <span class="w-5 h-5 bg-pink-500 text-white text-[10px] font-bold flex items-center justify-center rounded-full">1</span>
                        </div>
                    </div>
                `;
            } else if (tab === 'profile') {
                title.innerText = 'æˆ‘çš„æª”æ¡ˆ';
                body.innerHTML = `
                    <div class="px-6 py-4">
                        <div class="flex items-center mb-6">
                            <div class="w-16 h-16 bg-slate-200 rounded-full mr-4"></div>
                            <div>
                                <h2 class="text-lg font-black text-slate-900">User_Kevin</h2>
                                <p class="text-xs text-slate-500 font-bold">â­ï¸ 4.8 (12 æ¬¡äº¤æ›)</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                             <div class="bg-white p-3 rounded-xl shadow-sm border border-slate-100">
                                <div class="w-full h-24 bg-slate-100 rounded-lg mb-2"></div>
                                <p class="text-xs font-bold">NewJeans</p>
                             </div>
                        </div>
                    </div>
                `;
            }
        }

        function resetSimulator() {
            initSimulator();
        }

        // --- Trade Logic Visualization ---
        function highlightStep(step) {
            const detail = document.getElementById('flow-detail');
            let content = '';
            
            if(step === 1) {
                content = `
                    <div class="w-full animate-fade-in">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-bold text-indigo-400">Step 1: Initiate (ç™¼èµ·)</h4>
                            <span class="text-xs bg-indigo-900 text-indigo-300 px-2 py-1 rounded">UI Action</span>
                        </div>
                        <p class="text-sm text-slate-300">ä½¿ç”¨è€…åœ¨èŠå¤©å®¤é»æ“Šã€Œç™¼èµ·äº¤æ›ã€ï¼Œé¸æ“‡é›™æ–¹å¡ç‰‡ã€‚</p>
                        <div class="mt-3 p-2 bg-black/30 rounded text-xs font-mono text-slate-400">
                            POST /api/v1/trades<br>
                            Status -> 'proposed'
                        </div>
                    </div>
                `;
            } else if(step === 2) {
                content = `
                    <div class="w-full animate-fade-in">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-bold text-amber-400">Step 2: Negotiate (å”å•†)</h4>
                            <span class="text-xs bg-amber-900 text-amber-300 px-2 py-1 rounded">State Machine</span>
                        </div>
                        <p class="text-sm text-slate-300">æ¥æ”¶æ–¹å¯é¸æ“‡ [æ¥å—] æˆ– [æ‹’çµ•]ã€‚ç‹€æ…‹é–å®šå‰å¯å¤šæ¬¡ä¿®æ”¹ã€‚</p>
                        <div class="mt-3 p-2 bg-black/30 rounded text-xs font-mono text-slate-400">
                            Status -> 'negotiating' | 'accepted'
                        </div>
                    </div>
                `;
            } else if(step === 3) {
                 content = `
                    <div class="w-full animate-fade-in">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-bold text-blue-400">Step 3: Complete (å®Œæˆ)</h4>
                            <span class="text-xs bg-blue-900 text-blue-300 px-2 py-1 rounded">Logic</span>
                        </div>
                        <p class="text-sm text-slate-300">éœ€é›™æ–¹éƒ½é»æ“Šã€Œç¢ºèªå®Œæˆã€æŒ‰éˆ•ã€‚å–®æ–¹ç¢ºèªæ™‚ç‹€æ…‹ç‚º 'confirming'ã€‚</p>
                        <div class="mt-3 p-2 bg-black/30 rounded text-xs font-mono text-slate-400">
                            Update: Cards.status = 'traded'
                        </div>
                    </div>
                `;
            } else if(step === 4) {
                 content = `
                    <div class="w-full animate-fade-in">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-bold text-green-400">Step 4: Rating (è©•åƒ¹)</h4>
                            <span class="text-xs bg-green-900 text-green-300 px-2 py-1 rounded">Database</span>
                        </div>
                        <p class="text-sm text-slate-300">äº¤æ˜“çµæŸå¾Œå¼·åˆ¶å½ˆå‡ºè©•åˆ† Modalï¼Œå¯«å…¥ä¿¡è­½åˆ†æ•¸ã€‚</p>
                    </div>
                `;
            }
            detail.innerHTML = content;
        }

        // --- Chart Logic ---
        let myChart = null;

        function renderChart() {
            const ctx = document.getElementById('membershipChart');
            if(!ctx) return;
            
            // Destroy existing chart to avoid "Canvas is already in use" error
            if(myChart) {
                myChart.destroy();
            }

            myChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['æœå°‹ç¯„åœ', 'ä¸Šå‚³é™åˆ¶', 'æ’åºæ¬Šé‡', 'ä¿¡è­½å¾½ç« ', 'æ‰‹çºŒè²»æ¸›å…'],
                    datasets: [
                        { label: 'å…è²»ç‰ˆ', data: [30, 20, 40, 50, 20], backgroundColor: 'rgba(148, 163, 184, 0.2)', borderColor: '#94a3b8' },
                        { label: 'å°ˆæ¥­ç‰ˆ', data: [100, 100, 90, 85, 95], backgroundColor: 'rgba(79, 70, 229, 0.2)', borderColor: '#4F46E5' }
                    ]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    scales: {
                        r: { beginAtZero: true, max: 100, ticks: { display: false } }
                    }
                }
            });
        }

        // Initialize Simulator
        document.addEventListener('DOMContentLoaded', initSimulator);

    </script>
</body>
</html>